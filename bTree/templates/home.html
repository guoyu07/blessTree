<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!--<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no" />
    <title>{{ name }}的主页面</title>

    <!--CSS-->
    {% load staticfiles %}
    <link rel="stylesheet" type="text/css" href="{% static "tree/css/home.css" %}">
    <link rel="stylesheet" type="text/css" href="{% static "plugin/weui/weui.min.css" %}">
    <link href="//cdn.bootcss.com/pure/0.6.0/pure-min.css" rel="stylesheet">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-min.css">

    <!--js-->
    <script src="{% static "plugin/jquery/jquery.min.js" %}"></script>
    <script src="{% static "plugin/jquery/jquery.color.js" %}"></script>
    <script src="{% static "plugin/jquery/jquery.mobile-events.min.js" %}"></script>
    <script src="{% static "plugin/wechat-jssdk/weixin-1.0.0.js" %}"></script>
    <script src="{% static "tree/js/jquery.lqc.extension.js" %}"></script>
    {% if first_time %}
        <script src="{% static "tree/js/home_first.js.js" %}"></script>
    {% else %}
        <script src="{% static "tree/js/home.js" %}"></script>
    {% endif %}

</head>
<body class="my-body">
<!--顶部-->
<div class="menu-top">
    <div class="menu-top-con">
        <!--头像-->
        <div class="self-avatar">
{#            TODO:头像保存问题仍待解决，所以先不管 {% static "tree/image/btn/friends.png" %} #}
            <a><img class="avatar" src="{{ avatar_addr }}" style="width: inherit"></a>
        </div>
        <!--积分条-->
        <div class="count-progress">
            <div class="progress">
                <span class="progress-bar"><span class="progress-in" style="width: 85%"></span></span>
            </div>
            <div class="count-num"><p>积分：{{ count }}</p></div>
        </div>
        <!--排行-->
        <div class="rank">
            <a><img class="rank-btn" src="{% static "tree/image/btn/rank.png" %}" style="width: inherit"></a>
        </div>
        <!--提醒-->
        <div class="tips">
            <a><img class="tips-btn" src="{% static "tree/image/btn/tips.png" %}" style="width: inherit"></a>
        </div>
    </div>
</div>

<!--内容-->
<div class="main-container">
    <div class="main-tree pure-u-19-24" style="float: left;">
        <div class="tree-area"><img src="{% static "tree/image/others/tree.png" %}"></div>
        <div class="tree-name">
            <img src="{% static "tree/image/others/name.png" %}">
            <p class="name" style="margin-top: 19%;margin-left: 23%;">{{ name }}的树</p>
        </div>
    </div>
    <div class="main-right pure-u-5-24" style="float:left">
        <ul class="right-btn" style="list-style-type: none">
            <!--朋友-->
            <li><img class="friends" src="{% static "tree/image/btn/friends.png" %}" style="width: 74%"></li>
            <!--浇水-->
            <li><img class="water-flower" src="{% static "tree/image/btn/water.png" %}" style="width: 74%"></li>
            <!--历史-->
            <li><img class="history" src="{% static "tree/image/btn/history.png" %}" style="width: 74%"></li>
            <!--心愿-->
            <li><img class="willing" src="{% static "tree/image/btn/willing.png" %}" style="width: 74%"></li>
        </ul>
    </div>
</div>

<!--脚本-->
<div class="footer"></div>

{% if first_time %}
<!--begin 小部件-->
<!--mask-->
<div class="weui_mask" id="black-mask" style="display: none"></div>
<!--规则-->
<div class="rule" id="rule" >
    <div class="rule-title"><p>游戏规则</p></div>
    <div class="rule-list">
        <ul>
            <li><p style="width:15%">点击</p><img style="width: 15%" src="../static/tree/image/btn/water.png" ><p class="p-float" style="width:66% ">浇水一次得1000积分</p></li>
            <li><p style="width:15%">点击</p><img style="width: 15%" src="../static/tree/image/btn/willing.png"><p class="p-float" style="width:66%">添加新年愿望得20000积分</p></li>
            <li><p style="width:15%">点击</p><img style="width:15%" src="../static/tree/image/btn/friends.png"><p class="p-float" style="width:66%">并分享到朋友圈得5000积分，成功添加一位好友得3000积分</p></li>
            <li><p style="width:15%">点击</p><img style="width:15%" src="../static/tree/image/btn/rank.png"><p class="p-float" style="width:66%">访问好友并互动(祝福或吐槽)得5000积分</p></li>
        </ul>
    </div>
    <div class="rule-end"><p>当积分达到300000有特别的惊喜等你哦</p></div>
    <div class="rule-btn">
        <p class="rule-next" id="rule-next">下一步</p>
    </div>
</div>
<!--取名字-->
<div class="tips-quming" id="tips-quming" style="display: none">
    <p>小树苗出生了，快给它取个名字吧！</p>
    <button class="quming-btn">下一步</button>
</div>
<!--填写名字-->
<div class="fill-in-name" id="fill-in-name" style="display: none">
    <form class="fill-form">
        <input type="text" name="tree-name" placeholder="输入祝福树名字">
        <p class="fill-btn">确定</p>
    </form>
</div>
<!--浇水提醒-->
<div class="water-tips" id="water-tips" style="display: none;">
    <p>点击<img src="../static/tree/image/btn/water.png">&nbsp&nbsp给小树苗浇水，可以帮助它长成大树哦</p>
    <button class="water-tips-btn">去浇水<img src="../static/tree/image/btn/goto.png"></button>
</div>
<!--浇水成功-->
<div class="water-success" id="water-success" style="display: none;">
    <p>浇水成功，积分达到1000，小树苗变成大树啦！每隔10分钟可以浇一次水哦</p>
    <button>我知道啦</button>
</div>

{% endif %}
</body>
<script>
    $(function () {
        wx.config({
              debug: false,
              appId: '{{ app_id }}',
              timestamp: {{ timestamp }},
              nonceStr: '{{ noncestr }}',
              signature: '{{ signature }}',
              jsApiList: [
                'checkJsApi',
                'onMenuShareTimeline',
                'onMenuShareAppMessage',
              ]
        });
        wx.ready(function () {
            // 1 判断当前版本是否支持指定 JS 接口，支持批量判断
                wx.checkJsApi({
                    jsApiList: [
                        'getNetworkType',
                        'previewImage'
                    ]
                });

                wx.onMenuShareAppMessage({
                    title: '帅的人都点进去咯',
                    desc: '求新年红包？求约炮？多喝水，多看报；少吃零食，多睡觉，除了帅你也没啥优点了',
                    link: '{{ share_url }}',
                    imgUrl: 'http://img3.douban.com/view/movie_poster_cover/spst/public/p2166127561.jpg' ,
                    success: function (res) {
                        alert('分享成功，积分已奉上');
                      },
                      cancel: function (res) {
                        alert('分享一次，据说会有桃花运哦～');
                      },
                      fail: function (res) {
                        alert(JSON.stringify(res));
                      }
                })
                wx.onMenuShareTimeline({
                      title: '帅的人都点进去咯',
                      link: '{{ share_url }}',
                      imgUrl: 'http://img3.douban.com/view/movie_poster_cover/spst/public/p2166127561.jpg' ,
                      success: function (res) {
                        alert('分享成功，积分已奉上');
                      },
                      cancel: function (res) {
                        alert('分享一次，据说会有桃花运哦～');
                      },
                      fail: function (res) {
                        alert(JSON.stringify(res));
                      }
                });
        })
    })
</script>
</html>